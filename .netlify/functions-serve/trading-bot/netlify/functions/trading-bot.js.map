{
  "version": 3,
  "sources": ["../../../../../../Users/julius/Documents/Celiphili-merged/netlify/functions/trustlogiq-system.js", "../../../../../../Users/julius/Documents/Celiphili-merged/netlify/functions/trading-bot.js"],
  "sourceRoot": "/var/folders/1g/53cf88r51yngl1xgbxllrz900000gn/T/tmp-44489-AdazGvfag683",
  "sourcesContent": ["class TrustLogiQ {\n  constructor() {\n    this.apiKey = process.env.COINGLASS_API_KEY || 'b301b0371fd140c6800a1d11863bcf23';\n    this.baseUrl = 'https://open-api.coinglass.com/public/v2';\n    this.confidenceThreshold = 0.75;\n    this.minTradeConfidence = 0.6;\n    this.penaltyDecay = 0.95;\n    this.adaptationRate = 0.02;\n    this.penaltyPoints = {\n      liquidations: 0,\n      fundingRate: 0,\n      longShortRatio: 0,\n      openInterest: 0\n    };\n  }\n\n  async fetchCoinglass(endpoint, params = {}) {\n    const url = `${this.baseUrl}${endpoint}`;\n    const headers = {\n      'CG-API-KEY': this.apiKey,\n      'Content-Type': 'application/json'\n    };\n    \n    try {\n      const response = await fetch(url, { headers });\n      return await response.json();\n    } catch (error) {\n      console.error(`API Error: ${error}`);\n      return null;\n    }\n  }\n\n  async getMarketData(symbol) {\n    const [liquidations, funding, ratio, oi] = await Promise.all([\n      this.fetchCoinglass('/liquidation/chart', { symbol, time: '1h' }),\n      this.fetchCoinglass('/funding_rate', { symbol }),\n      this.fetchCoinglass('/global_long_short', { symbol }),\n      this.fetchCoinglass('/open_interest/chart', { symbol, time: '4h' })\n    ]);\n\n    return {\n      liquidations: this.parseLiquidations(liquidations),\n      fundingRate: funding?.data?.[0]?.rate || 0,\n      longShortRatio: ratio?.data?.longShortRatio || 1,\n      openInterest: this.calculateOIChange(oi)\n    };\n  }\n\n  parseLiquidations(data) {\n    if (!data?.data) return 0;\n    const recent = data.data.slice(-1)[0];\n    return (recent?.buyVol || 0) - (recent?.sellVol || 0);\n  }\n\n  calculateOIChange(data) {\n    if (!data?.data || data.data.length < 2) return 0;\n    const current = data.data[data.data.length - 1]?.value || 0;\n    const previous = data.data[data.data.length - 2]?.value || 1;\n    return ((current - previous) / previous) * 100;\n  }\n\n  normalizeToSignal(value, key) {\n    const thresholds = {\n      liquidations: { bull: 50000000, bear: -50000000 },\n      fundingRate: { bull: -0.03, bear: 0.05 },\n      longShortRatio: { bull: 0.85, bear: 1.15 },\n      openInterest: { bull: 10, bear: -10 }\n    };\n\n    const t = thresholds[key];\n    if (!t) return 0;\n\n    switch(key) {\n      case 'liquidations':\n        return value > t.bull ? 1 : value < t.bear ? -1 : value / t.bull;\n      case 'fundingRate':\n        return value < t.bull ? 1 : value > t.bear ? -1 : -value / t.bear;\n      case 'longShortRatio':\n        return value < t.bull ? 1 : value > t.bear ? -1 : (1 - value) * 5;\n      case 'openInterest':\n        return value > t.bull ? 1 : value < t.bear ? -1 : value / t.bull;\n      default:\n        return 0;\n    }\n  }\n\n  calculateConfidence(inputs) {\n    let weightedScore = 0;\n    let totalWeight = 0;\n    \n    Object.entries(inputs).forEach(([key, value]) => {\n      const weight = Math.max(0.1, 1 - this.penaltyPoints[key]);\n      const signal = this.normalizeToSignal(value, key);\n      weightedScore += signal * weight;\n      totalWeight += weight;\n    });\n    \n    return totalWeight > 0 ? weightedScore / totalWeight : 0;\n  }\n\n  getRecommendation(confidence) {\n    if (Math.abs(confidence) >= this.confidenceThreshold) {\n      return { action: confidence > 0 ? \"LONG\" : \"SHORT\", execute: true };\n    }\n    if (Math.abs(confidence) >= this.minTradeConfidence) {\n      return { action: confidence > 0 ? \"LONG\" : \"SHORT\", execute: false };\n    }\n    return { action: \"HOLD\", execute: false };\n  }\n\n  adaptSystem(correct, inputs) {\n    Object.keys(inputs).forEach(key => {\n      if (correct) {\n        this.penaltyPoints[key] *= this.penaltyDecay;\n      } else {\n        this.penaltyPoints[key] += 0.05;\n      }\n    });\n  }\n\n  async analyze(symbol) {\n    const marketData = await this.getMarketData(symbol);\n    const confidence = this.calculateConfidence(marketData);\n    const recommendation = this.getRecommendation(confidence);\n    \n    return {\n      symbol,\n      confidence: Math.round(confidence * 100),\n      recommendation,\n      data: marketData,\n      timestamp: new Date().toISOString()\n    };\n  }\n}\n\nclass AlertSystem {\n  constructor(botToken, chatId) {\n    this.botToken = botToken;\n    this.chatId = chatId;\n    this.telegramUrl = `https://api.telegram.org/bot${botToken}`;\n  }\n\n  async sendAlert(message) {\n    console.log(`ALERT: ${message}`);\n    // Telegram integration would go here\n  }\n}\n\nclass TradingBot {\n  constructor() {\n    this.trustlogiq = new TrustLogiQ();\n    this.symbols = ['BTC', 'ETH', 'SOL'];\n    this.alerts = new AlertSystem(\n      process.env.TELEGRAM_BOT_TOKEN || 'YOUR_BOT_TOKEN',\n      process.env.TELEGRAM_CHAT_ID || 'YOUR_CHAT_ID'\n    );\n    this.tradeHistory = [];\n  }\n\n  async run() {\n    console.log(`[${new Date().toISOString()}] Running analysis...`);\n    const results = [];\n    \n    for (const symbol of this.symbols) {\n      try {\n        const analysis = await this.trustlogiq.analyze(symbol);\n        \n        if (analysis.recommendation.execute) {\n          const alert = `\uD83D\uDEA8 ${symbol} SIGNAL\nAction: ${analysis.recommendation.action}\nConfidence: ${analysis.confidence}%\nLiquidations: $${(analysis.data.liquidations / 1e6).toFixed(2)}M\nFunding: ${(analysis.data.fundingRate * 100).toFixed(3)}%\nL/S Ratio: ${analysis.data.longShortRatio.toFixed(3)}\nOI Change: ${analysis.data.openInterest.toFixed(2)}%`;\n          \n          await this.alerts.sendAlert(alert);\n          this.tradeHistory.push(analysis);\n        }\n        \n        console.log(`${symbol}: ${analysis.recommendation.action} (${analysis.confidence}%)`);\n        results.push(analysis);\n      } catch (error) {\n        console.error(`Error analyzing ${symbol}:`, error);\n      }\n    }\n    \n    return results;\n  }\n}\n\nmodule.exports = { TrustLogiQ, TradingBot };", "const { TrustLogiQ, TradingBot } = require('./trustlogiq-system');\n\nexports.handler = async (event, context) => {\n  // CORS headers\n  const headers = {\n    'Access-Control-Allow-Origin': '*',\n    'Access-Control-Allow-Headers': 'Content-Type',\n    'Access-Control-Allow-Methods': 'GET, POST, OPTIONS'\n  };\n\n  // Handle preflight\n  if (event.httpMethod === 'OPTIONS') {\n    return { statusCode: 200, headers, body: '' };\n  }\n\n  const bot = new TradingBot();\n  \n  try {\n    const results = await bot.run();\n    \n    return {\n      statusCode: 200,\n      headers,\n      body: JSON.stringify({ \n        success: true,\n        message: 'Analysis complete',\n        data: results,\n        timestamp: new Date().toISOString()\n      })\n    };\n  } catch (error) {\n    console.error('Bot error:', error);\n    return {\n      statusCode: 500,\n      headers,\n      body: JSON.stringify({ \n        success: false,\n        error: error.message \n      })\n    };\n  }\n};"],
  "mappings": "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",
  "names": ["TrustLogiQ", "TradingBot"]
}
